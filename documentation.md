<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Introduction][1]
-   [Bar_Graph_Functions][2]
    -   [dataColor][3]
    -   [colorArray][4]
    -   [attColorArray][5]
    -   [btoColorArray][6]
    -   [simpleColorArray][7]
    -   [barGraph][8]
    -   [arrayValues][9]
    -   [raceArrayValues][10]
    -   [subgroupArrayValues][11]
-   [Text_Functions][12]
    -   [ccrpiText][13]
    -   [milesText][14]
    -   [sgpText][15]
    -   [gradText][16]
    -   [btoText][17]
    -   [attText][18]
    -   [enrollText][19]
    -   [subgroupText][20]
    -   [raceText][21]
    -   [climateText][22]
-   [Line_Graph_Functions][23]
    -   [lineGraph][24]
    -   [yearData][25]
    -   [lineData][26]
    -   [lineColorArray][27]
-   [Button_Functions][28]
    -   [switchToBar][29]
    -   [switchToLine][30]
    -   [buttonUpdate][31]
    -   [makeButtons][32]
-   [General][33]
    -   [shortName][34]
    -   [maxYear][35]
    -   [getMessage][36]
    -   [checkLevels][37]
    -   [matchStart][38]
    -   [PrintPage][39]
    -   [filterLevel][40]
-   [Bar_Graph2_Functions][41]
    -   [barGraph2][42]
    -   [combineRaceArray][43]

## Introduction

Function list for code to generate School Profiles on APS Insights.

**Meta**

-   **author**: John Keltz

## Bar_Graph_Functions

These functions generate the bar graphs, or support that purpose.

### dataColor

This function compares a school value to the district and state values and outputs the bar color for the school value.

**Parameters**

-   `school` **[number][44]** the school data point
-   `district` **[number][44]** the district average data point
-   `state` **[number][44]** the state average data point

Returns **[string][45]** the hex code for the bar graph color

### colorArray

This function recieves the bar graph array and outputs the color array. It calls [dataColor][46] to build the color array.

**Parameters**

-   `matrix` **[array][47]** data array that will generate the bar graph

Returns **[array][47]** an array of color hex codes to color the bar graph

### attColorArray

This function recieves the attendance bar graph array and outputs the color array. It calls dataColor to build the color array. It's similar to colorArray but does not use a state value.

**Parameters**

-   `matrix` **[array][47]** data array that will generate the bar graph

Returns **[array][47]** an array of color hex codes to color the bar graph

### btoColorArray

This function makes the color array for Beat the Odds by looking up the bto_status value for the current selection.

**Parameters**

-   `array` **[array][47]** data array that will generate the bar graph
-   `year` **[number][44]** year of the BTO data
-   `dataset` **[array][47]** school profile source data

Returns **[array][47]** an array of color hex codes to color the bar graph

### simpleColorArray

This function passes an all blue color array the same length as the data. This allows the subgroup graphs to use the same bar graph function as the achievement graphs.

**Parameters**

-   `array` **[array][47]** data array that will generate the bar graph

Returns **[array][47]** an array of color hex codes to color the bar graph

### barGraph

This function generates a bar graph using c3.js.

**Parameters**

-   `dataArray` **[array][47]** Array formatted for cs.js graph function. This is usually generated by the function arrayValues. First line is school names, second line is values corresponding to school names.
-   `colors` **[array][47]** List of hex colors for bar graph. Usually generated by [colorArray][48] or a similar function.
-   `labelFormat` **[string][45]** d3.js label format. Usually '.0%' or '.1f' (i.e a percentage with zero decimals, or a regular number with one decimal.)
-   `divID` **[string][45]** name of the div ID where the graph should go.

Returns **[object][49]** A bar graph attached to the selected div ID.

### arrayValues

This function makes a data array that can be used by the barGraph function.

**Parameters**

-   `subject` **[string][45]** the name of the column in the source data containing our values
-   `school` **[string][45]** long school name, as shown in the filter
-   `compareSchool` **[string][45]** long comparison school name, as shown in the filter
-   `year` **[string][45]** selected year
-   `dataset` **[array][47]** school profile data file

Returns **[array][47]** First line is school names, second line is values corresponding to school names.

### raceArrayValues

This function makes a data array that can be used by the barGraph function. Not many input variables b/c school should only have one data line with race values.

**Parameters**

-   `school` **[string][45]** long school name, as shown in the filter
-   `dataset` **[array][47]** school profile data file

Returns **[array][47]** First line is race/ethnicity names, second line is percentages.

### subgroupArrayValues

This function makes a data array that can be used by the barGraph function. Not many input variables b/c school should only have one data line with subgroup values.

**Parameters**

-   `school` **[string][45]** long school name, as shown in the filter
-   `dataset` **[array][47]** school profile data file

Returns **[array][47]** First line is subgroup names, second line is percentages.

## Text_Functions

These functions generate the short descriptive text next to the graphs.

### ccrpiText

This function writes the text next to the CCRPI graph.

**Parameters**

-   `selectedSchoolName` **[string][45]** short version of school name
-   `selectedSchoolValue` **[number][44]** school ccrpi score
-   `selectedYear` **[string][45]** selected year

Returns **[string][45]** Text next to the CCRPI graph

### milesText

This function writes the text next to the Milestones graph.

**Parameters**

-   `selectedSchoolName` **[string][45]** short version of school name
-   `english` **[number][44]** the school's english proficiency rate
-   `math` **[number][44]** the school's math proficiency rate
-   `selectedYear` **[string][45]** selected year

Returns **[string][45]** Text next to the Milestones graph

### sgpText

This function writes the text next to the student growth graph.

**Parameters**

-   `selectedSchoolName` **[string][45]** short version of school name
-   `math` **[number][44]** the school's math SGP score
-   `selectedYear` **[string][45]** selected year

Returns **[string][45]** Text next to the Milestones graph

### gradText

This function writes the text next to the graduation graph.

**Parameters**

-   `selectedSchoolName` **[string][45]** short version of school name
-   `gradrate` **[number][44]** the school's graduation rate
-   `selectedYear` **[string][45]** selected year

Returns **[string][45]** Text next to the Milestones graph

### btoText

This function writes the text next to the beat the odds graph.

**Parameters**

-   `selectedSchoolName` **[string][45]** short version of school name
-   `score` **[number][44]** the school's beat the odds score
-   `selectedYear` **[string][45]** selected year

Returns **[string][45]** Text next to the BTO graph

### attText

This function writes the text next to the attendance graph.

**Parameters**

-   `selectedSchoolName` **[string][45]** short version of school name
-   `score` **[number][44]** the school's attendance rate
-   `selectedYear` **[string][45]** selected year

Returns **[string][45]** Text next to the attendance graph

### enrollText

This function writes the text next to the enrollment graph. It uses the global variable selectedSchoolName to identify school.

**Parameters**

-   `dataMatrix` **[array][47]** source data fro school profile
-   `yearMatrix` **[array][47]** list of years with enrollment data

Returns **[string][45]** Text next to the enrollment graph

### subgroupText

This function writes the text next to the subgroup graph. Unlike other text, it focuses on explaining the data dates, which aren't otherwise clear.

**Parameters**

-   `subgroupDate` **[string][45]** the year that the subgroup data is from
-   `mobilityDate` **[number][44]** the year that the mobility data is from
-   `directCertDate` **[string][45]** the year that the direct cert data is from

Returns **[string][45]** Text next to the subgroup graph

### raceText

This function writes the text next to the race graph.

**Parameters**

-   `school` **[string][45]** school name
-   `compareSchool` **[string][45]** compare school name
-   `tempYear` **[string][45]** selected year

Returns **[string][45]** Text next to the race graph

### climateText

This function writes the text next to the climate graph.

**Parameters**

-   `school` **[string][45]** school name
-   `score` **[number][44]** school's result on "I feel safe at school" question
-   `tempYear` **[string][45]** selected year

Returns **[string][45]** Text next to the climate graph

## Line_Graph_Functions

These functions generate the line graphs, or support that purpose.

### lineGraph

This function generates a line graph using c3.js.

**Parameters**

-   `dataArray` **[array][47]** Array formatted for cs.js graph function. This is generated by the function [lineData][50]. Each row is a school name and then a list of values by year.
-   `yearArray` **[array][47]** List of years for the line graph. This is generated by the function [yearData][51].
-   `lineColor` **[array][47]** Array of hex colors for line graph. This is generated by the function [lineColorArray][52].
-   `title` **[string][45]** Title at the top of the graph.
-   `divName`  
-   `divID` **[string][45]** name of the div ID where the graph should go.

Returns **[object][49]** A line graph attached to the selected div ID.

### yearData

This functionmakes a list of years that contain non-null values.

**Parameters**

-   `subject` **[string][45]** column name in the dataset that contains our values
-   `dataset` **[string][45]** school profile source data

### lineData

This function makes a data array that can be used by [lineGraph][53].

**Parameters**

-   `subject` **[string][45]** the name of the column in the source data containing our values
-   `selectedSchool` **[string][45]** long school name, as shown in the filter
-   `compareSchool` **[string][45]** long comparison school name, as shown in the filter
-   `dataset` **[array][47]** school profile data file
-   `yearArray` **[array][47]** list of relevant years, created by [yearData][51]

Returns **[array][47]** First line is school names, second line is values corresponding to school names.

### lineColorArray

This function makes a color list to send to [lineGraph][53]. It cycles through the Tableau color pallette and then uses shades of gray for the district and state.

**Parameters**

-   `subject` **[string][45]** the name of the column in the source data containing our values
-   `matrix`  
-   `line` **[array][47]** graph data, created by [lineData][50]

Returns **[array][47]** List of colors.

## Button_Functions

These functions generate or toggle buttons, or support that purpose.

### switchToBar

This function hides the Milestones line graph and shows the bar graph.

### switchToLine

This function hides the Milestones bar graph and shows the line graph.

### buttonUpdate

This function makes the selected button bold.

**Parameters**

-   `year` **[string][45]** selected year
-   `content` **[string][45]** nickname used for content area when naming divs and IDs

### makeButtons

This function writes html code to make buttons. It loops through the data to make a button for each year that contains non-null values.

**Parameters**

-   `content` **[string][45]** nickname used for content area when naming divs and IDs
-   `column` **[string][45]** column in the dataset that contains our values
-   `idName` **[string][45]** div ID where the buttons will be drawn
-   `dataset` **[string][45]** school profile source data

## General

These functions are used for a stand-alone purpose or to support several other areas.

### shortName

This function looks up the short name for a school.

**Parameters**

-   `school` **[string][45]** long schoolname, as shown in the filter.
-   `dataset` **[array][47]** school profile data file

Returns **[string][45]** short school name

### maxYear

This function finds the max year for a given field. This is then used for default graph selections.

**Parameters**

-   `column` **[string][45]** column name in the dataset that contains our values
-   `dataset` **[string][45]** school profile source data

### getMessage

This function checks for messages about the school, such as 'the school is the result of a recent merger...'.

**Parameters**

-   `school` **[string][45]** name of school
-   `dataset` **[array][47]** school profile data file

Returns **[string][45]** message that the school is new, or has a recent merger, and how this impacts the data.

### checkLevels

This function checks whether the school has multiple levels and, if so, generates a message.

**Parameters**

-   `school1` **[string][45]** name of school
-   `dataset1` **[array][47]** school profile data file
-   `gradeLevel` **[string][45]** selected grade level

Returns **[string][45]** message that the school has multiple grade levels and how this impacts the data.

### matchStart

This function is used by the select2 filter so it will only search text that matches the beginning of the school name (i.e. "m" matches Morningside and Miles only

**Parameters**

-   `params`  
-   `data`  

### PrintPage

This function opens a print window and makes a printer-friendly version of the school profile. Note we pass current css libraries tot the new page, plus "printschoolprofilestyle.css" which adds custom css to drop things we don't want to print, like navigation icons and info buttons. The ws.css library, "custom_w3.css" is also edited, to get the print layout to show the desktop view instead of mobile.

### filterLevel

This function is run when a user selects a grade level, and then kicks off the school filters.

## Bar_Graph2_Functions

### barGraph2

This function generates a bar graph using c3.js. Similar to [barGraph][54], but for graphing two schools per category, used for race/ethnicity and subgroups when there is a comparison school.

**Parameters**

-   `dataArray` **[array][47]** Array formatted for cs.js graph function. This is generated by the function [combineRaceArray][55]. First line is school names, second line is values corresponding to school names.
-   `labelFormat` **[string][45]** d3.js label format. Usually '.0%' or '.1f' (i.e a percentage with zero decimals, or a regular number with one decimal.)
-   `divID` **[string][45]** name of the div ID where the graph should go.

Returns **[object][49]** A bar graph with two schools per category (i.e. race or subgroup) attached to the selected div ID.

### combineRaceArray

This function combines race arrays for two schools into one data array that can be used by the barGraph2 function. Also used to combine subgroup arrays.

**Parameters**

-   `school1` **[string][45]** long school name, as shown in the filter
-   `school2` **[string][45]** long comparison school name, as shown in the filter
-   `raceMatrix1`  
-   `raceMatrix2`  
-   `values` **[array][47]** generated by [raceArrayValues][56] for school 1
-   `values` **[array][47]** generated by [raceArrayValues][56] for school 2

Returns **[array][47]** First line is race/ethnicity names, second and third line are percentages by school.

[1]: #introduction

[2]: #bar_graph_functions

[3]: #datacolor

[4]: #colorarray

[5]: #attcolorarray

[6]: #btocolorarray

[7]: #simplecolorarray

[8]: #bargraph

[9]: #arrayvalues

[10]: #racearrayvalues

[11]: #subgrouparrayvalues

[12]: #text_functions

[13]: #ccrpitext

[14]: #milestext

[15]: #sgptext

[16]: #gradtext

[17]: #btotext

[18]: #atttext

[19]: #enrolltext

[20]: #subgrouptext

[21]: #racetext

[22]: #climatetext

[23]: #line_graph_functions

[24]: #linegraph

[25]: #yeardata

[26]: #linedata

[27]: #linecolorarray

[28]: #button_functions

[29]: #switchtobar

[30]: #switchtoline

[31]: #buttonupdate

[32]: #makebuttons

[33]: #general

[34]: #shortname

[35]: #maxyear

[36]: #getmessage

[37]: #checklevels

[38]: #matchstart

[39]: #printpage

[40]: #filterlevel

[41]: #bar_graph2_functions

[42]: #bargraph2

[43]: #combineracearray

[44]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[45]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[46]: dataColor

[47]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[48]: colorArray

[49]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[50]: lineData

[51]: yearData

[52]: lineColorArray

[53]: lineGraph

[54]: barGraph

[55]: combineRaceArray

[56]: raceArrayValues
